<section class="selection-panel">
    <div class="selection-grid" style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
        <div>
            <label class="selection-label" for="projectSelect">📁 選擇專案</label>
            <select class="form-select" id="projectSelect">
                <option value="">請選擇專案...</option>
            </select>
        </div>
        <div>
            <label class="selection-label" for="tenderSelect">📋 選擇標單</label>
            <select class="form-select" id="tenderSelect" disabled>
                <option value="">請先選擇專案</option>
            </select>
        </div>
        <div>
            <label class="selection-label" for="majorItemSelect">🔧 選擇大項目</label>
            <select class="form-select" id="majorItemSelect" disabled>
                <option value="">請先選擇標單</option>
            </select>
        </div>
        <div>
            <label class="selection-label" for="floorSelect">🏢 選擇樓層</label>
            <select class="form-select" id="floorSelect" disabled>
                <option value="">請先選擇大項</option>
            </select>
        </div>
    </div>
</section>

<div class="content-card" id="contentCard">
    <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <p>載入分配資料中...</p>
    </div>

    <div id="mainContent" style="display: none;">
        <div class="actions-panel">
            <h2 id="currentLocation" style="color: #333; font-size: 20px;"></h2>
            <div class="action-buttons">
                <button id="saveSpaceDistributionsBtn" class="btn btn-success">💾 儲存空間分配</button>
                <button id="spaceManagerBtn" class="btn btn-info">📐 管理空間</button>
            </div>
        </div>

        <div class="table-container">
            <table class="distribution-table" id="spaceDistributionTable">
                <thead id="tableHeader"></thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
        
        <div id="noSpacesState" class="empty-state" style="display: none;">
            <div class="empty-state-icon">🚪</div>
            <p>這個樓層還沒有定義任何空間。<br>請點擊上方的「管理空間」按鈕來新增空間。</p>
        </div>
    </div>
    
    <div id="initialEmptyState" class="empty-state" style="display: flex;">
        <div class="empty-state-icon">↖️</div>
        <p>請從上方的下拉選單選擇「專案」、「標單」、「大項目」及「樓層」以開始作業</p>
    </div>
</div>

<div id="spaceModal" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 600px;">
        <h3>📐 <span id="currentFloorName"></span> - 空間設定管理</h3>
        <p>為您選擇的樓層新增、編輯或刪除空間。支援批次新增，例如：「201-210,大廳,梯廳」。</p>
        
        <div class="modal-section">
            <h4>✏️ 自訂空間</h4>
            <div class="custom-add-section">
                <input type="text" id="newSpaceInput" class="form-control" placeholder="輸入空間名稱，用逗號或連字號分隔">
                <button id="addCustomSpaceBtn" class="btn btn-success">➕ 新增</button>
            </div>
        </div>

        <div class="modal-section">
            <h4>🎯 目前空間設定</h4>
            <div id="currentSpacesList" class="floor-tags"></div>
        </div>

<div id="mainContent" style="display: none;">
        <div class="actions-panel">
            <h2 id="currentLocation" style="color: #333; font-size: 20px;"></h2>
            <div class="action-buttons">
                <button id="saveSpaceDistributionsBtn" class="btn btn-success">💾 儲存空間分配</button>
                <button id="importBtn" class="btn btn-primary">📥 匯入 Excel</button>
                <input type="file" id="importInput" accept=".xlsx, .xls" style="display: none;">
                <button id="exportBtn" class="btn btn-warning">📤 匯出 Excel</button>
                <button id="spaceManagerBtn" class="btn btn-info">📐 管理空間</button>
            </div>
        </div>
    </div>
</div>

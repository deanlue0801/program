<div class="page-container">
    <div class="page-header">
        <h1 class="page-title">標單採購管理</h1>
        <p class="page-subtitle">在此建立、追蹤並管理標單項目的採購訂單。</p>
    </div>

    <section class="selection-panel card">
        <div class="selection-grid">
            <div>
                <label class="selection-label" for="projectSelect">📁 選擇專案</label>
                <select class="form-select" id="projectSelect"></select>
            </div>
            <div>
                <label class="selection-label" for="tenderSelect">📋 選擇標單</label>
                <select class="form-select" id="tenderSelect" disabled></select>
            </div>
            <div>
                <label class="selection-label" for="majorItemSelect">🔧 篩選大項目 (可選)</label>
                <select class="form-select" id="majorItemSelect" disabled></select>
            </div>
        </div>
    </section>

    <div class="procurement-body">
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>載入資料中...</p>
        </div>

        <div id="mainContent" style="display: none;">
            <div class="table-container">
                <table class="data-table" id="procurementTable">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
        
        <div id="emptyState" class="empty-state" style="display: flex;">
            <p>請從上方選擇「專案」與「標單」以載入採購項目。</p>
        </div>
    </div>
</div>

<div id="orderModal" class="modal-overlay">
    <div class="modal-content">
        <h3 id="modalTitle">新增採購單</h3>
        <form id="orderForm">
            <input type="hidden" id="orderId">
            <input type="hidden" id="detailItemId">
            <div class="form-group">
                <label>採購項目</label>
                <p id="itemNameDisplay" style="font-weight: bold;"></p>
            </div>
            <div class="form-group">
                <label for="supplier">供應商</label>
                <input type="text" id="supplier" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="purchaseQuantity">採購數量</label>
                <input type="number" id="purchaseQuantity" class="form-control" required min="0">
            </div>
            <div class="form-group">
                <label for="unitPrice">採購單價</label>
                <input type="number" id="unitPrice" class="form-control" required min="0">
            </div>
            <div class="form-group">
                <label for="status">狀態</label>
                <select id="status" class="form-select">
                    <option value="草稿">草稿</option>
                    <option value="已下訂">已下訂</option>
                    <option value="已到貨">已到貨</option>
                    <option value="已付款">已付款</option>
                </select>
            </div>
            <div class="form-group">
                <label for="orderDate">下訂日期</label>
                <input type="date" id="orderDate" class="form-control">
            </div>
            <div class="form-group">
                <label for="notes">備註</label>
                <textarea id="notes" class="form-control" rows="3"></textarea>
            </div>
            <div class="modal-actions">
                <button type="submit" class="btn btn-success">儲存</button>
                <button type="button" id="cancelModalBtn" class="btn btn-secondary">取消</button>
            </div>
        </form>
    </div>
</div>

<div class="page-container">
    <div class="page-header">
        <h1 class="page-title">標單採購管理</h1>
        <div class="actions-panel" style="margin-top: 1rem;">
            <button id="exportRfqBtn" class="btn btn-primary">📄 匯出詢價單 (Excel)</button>
            <button id="importQuotesBtn" class="btn btn-info">📥 匯入報價單 (Excel)</button>
            <input type="file" id="importQuotesInput" accept=".xlsx, .xls" style="display: none;">
        </div>
    </div>

    <section class="selection-panel card">
        </section>

    <div class="procurement-body">
        <div id="mainContent" style="display: none;">
            <div class="table-container">
                <table class="data-table" id="procurementTable">
                    <thead>
                        <tr>
                            <th style="width: 8%;">項次</th>
                            <th>項目名稱</th>
                            <th class="text-right" style="width: 10%;">合約數量</th>
                            <th class="text-right" style="width: 10%;">已採購</th>
                            <th class="text-right" style="width: 10%;">剩餘</th>
                            <th style="width: 25%;">採購單/報價</th>
                            <th style="width: 10%;">操作</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div id="orderModal" class="modal-overlay">
    </div>

<div id="priceCompareModal" class="modal-overlay">
    <div class="modal-content" style="max-width: 800px;">
        <h3 id="compareModalTitle">廠商報價比價</h3>
        <p id="compareItemName"></p>
        <div class="table-container" style="margin-top: 1rem;">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>供應商</th>
                        <th class="text-right">報價單價</th>
                        <th>備註</th>
                        <th style="width: 15%;">操作</th>
                    </tr>
                </thead>
                <tbody id="compareTableBody"></tbody>
            </table>
        </div>
        <div class="modal-actions" style="justify-content: flex-end;">
            <button type="button" id="cancelCompareModalBtn" class="btn btn-secondary">關閉</button>
        </div>
    </div>
</div>
